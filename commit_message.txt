Refactor: Improve error handling, remove direct DOM manipulation, and fix hardcoded path